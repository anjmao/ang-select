<div (click)="handleSelectClick($event)" class="as-control">
    <span class="as-multi-value-wrapper">

        <span class="as-placeholder" *ngIf="showPlaceholder()">{{placeholder}}</span>

        <ng-container *ngIf="!multiple;else multipleValue">
            <div class="as-value" *ngIf="showValue()">
                    <span class="as-value-label" role="option" aria-selected="true">
                            <ng-template 
                                *ngIf="labelTemplate" 
                                [ngTemplateOutlet]="labelTemplate"
                                [ngTemplateOutletContext]="getDisplayTemplateContext()">
                            </ng-template>
                            <span *ngIf="!labelTemplate">{{getLabelValue(value)}}</span>
                    </span>
            </div>
        </ng-container>

        <ng-template #multipleValue>
            <div class="as-value" *ngFor="let item of value">
                <span class="as-clear" (click)="unselect(item)" aria-hidden="true">×</span>
                <span class="as-value-label" aria-selected="true">{{getLabelValue(item)}}</span>
            </div>
        </ng-template>

        <div *ngIf="showFilter()" class="as-input">
            <input #filterInput
                   [value]="filterValue"
                   (input)="onFilter($event)"
                   (focus)="onInputFocus($event)"
                   (blur)="onInputBlur($event)"
                   role="combobox"
                   aria-expanded="false"
                   aria-owns=""
                   aria-haspopup="false">
        </div>
    </span>

    <spinner class="as-spinner-zone" *ngIf="isLoading"></spinner>

    <span *ngIf="showClear()" (click)="handleClearClick($event)" class="as-clear-zone" title="Clear all" aria-label="Clear all">
        <span class="as-clear" aria-hidden="true">×</span>
    </span>

    <span (click)="handleArrowClick($event)" class="as-arrow-zone">
        <span class="as-arrow"></span>
    </span>
</div>

<div class="as-menu-outer">
    <virtual-scroll role="listbox" class="as-menu" [bufferAmount]="4" [items]="itemsList.filteredItems" (update)="viewPortItems = $event">
        <div class="as-option" role="option" (click)="toggle(item)" (mousedown)="$event.preventDefault()" (mouseover)="onItemHover(item)"
             *ngFor="let item of viewPortItems"
             [class.disabled]="item.disabled"
             [class.selected]="item.selected"
             [class.marked]="item === itemsList.markedItem">

            <span *ngIf="!optionTemplate">{{item[bindLabel]}}</span>

            <ng-template  *ngIf="optionTemplate"
                          [ngTemplateOutlet]="optionTemplate"
                          [ngTemplateOutletContext]="{ item: item, index: item.index }">
            </ng-template>
        </div>
    </virtual-scroll>

    <div class="as-menu" *ngIf="showNoItemsFound()">
        <div class="as-option disabled">
            {{notFoundText}}
        </div>
    </div>

    <div class="as-menu" *ngIf="showTypeToSearch()">
        <div class="as-option disabled">
            {{typeToSearchText}}
        </div>
    </div>
</div>
